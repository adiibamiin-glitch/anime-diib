<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>الحلقات — ANIME DIIB</title>
    <link rel="stylesheet" href="style.css" />
</head>
<body>
    <header class="site-header">
        <div class="container header-inner">
            <a class="nav-link" href="index.html">الرئيسية</a>
            <a class="nav-link" href="shows.html">المسلسلات</a>
        </div>
    </header>

    <main class="container">
        <h1 id="series-title" class="page-title">الحلقات</h1>
        <div id="episodes-grid" class="episodes-grid"></div>
    </main>

    <script src="data.js"></script>
    <script>
    (function(){
        function qs(n){ return new URLSearchParams(location.search).get(n); }
        const id = qs('id');
        const titleEl = document.getElementById('series-title');
        const grid = document.getElementById('episodes-grid');
        if(!id){ titleEl.textContent = 'لم يتم تحديد المسلسل'; grid.innerHTML=''; return; }
        const catalog = DIIB.getCatalog();
        const show = (catalog.shows||[]).find(s=>s.id===id);
        if(!show){ titleEl.textContent='المسلسل غير موجود'; return; }
        titleEl.textContent = show.title;
        const eps = show.episodes || [];
        grid.innerHTML='';
        eps.forEach(ep=>{
            const el = document.createElement('div'); el.className='episode-card';
            el.innerHTML = `
                <a class="card-link" href="player.html?src=${encodeURIComponent(ep.src)}&title=${encodeURIComponent(show.title+' - '+ep.title)}&poster=${encodeURIComponent(ep.poster||show.poster||'')}">
                    <img src="${ep.poster||show.poster||'screen1.jpg'}" alt="${ep.title}" loading="lazy" />
                    <div class="episode-meta">
                        <h4>${ep.title}</h4>
                        <div class="ep-sub">حلقة ${ep.episode||''}</div>
                    </div>
                </a>
            `;
            grid.appendChild(el);
        });
    })();
    </script>
</body>
</html>
